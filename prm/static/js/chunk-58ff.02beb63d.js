(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-58ff"],{HvKk:function(t,e,l){"use strict";l.d(e,"c",function(){return a}),l.d(e,"b",function(){return i}),l.d(e,"a",function(){return n}),l.d(e,"k",function(){return o}),l.d(e,"i",function(){return r}),l.d(e,"j",function(){return c}),l.d(e,"d",function(){return u}),l.d(e,"f",function(){return d}),l.d(e,"h",function(){return m}),l.d(e,"e",function(){return g}),l.d(e,"g",function(){return p});var s=l("t3Un");function a(t,e){return Object(s.a)({url:"/logs/getAllLogsByPage/?pageSize="+t+"&pageNum="+e,method:"get"})}function i(t,e,l){return Object(s.a)({url:"/logs/getAllLogsByName/?pageSize="+t+"&pageNum="+e+"&name="+l,method:"get"})}function n(t){return Object(s.a)({url:"/logs/delete/"+t,method:"get"})}function o(t){return Object(s.a)({url:"/logs/getDetail/?id="+t,method:"get"})}function r(t){return Object(s.a)({url:"/logs/logsGetDetailInsert",method:"post",data:t})}function c(t){return Object(s.a)({url:"/logs/logsGetDetailUpdate",method:"post",data:t})}function u(){return Object(s.a)({url:"/project/getAlltasks",method:"get"})}function d(t){return Object(s.a)({url:"/users/getUserByExample",method:"post",data:t})}function m(t){return Object(s.a)({url:"/task/autoPlan",method:"post",data:t})}function g(){return Object(s.a)({url:"/users/getAllUser",method:"get"})}function p(t){return Object(s.a)({url:"/logs/logsGetDetailAutoInsert",method:"post",data:t})}},JH6o:function(t,e,l){"use strict";l.r(e);var s=l("EJiy"),a=l.n(s),i=l("gDS+"),n=l.n(i),o=l("HvKk"),r=l("X4fA"),c={name:"Edit",data:function(){return{rowId:"",loading:!1,value:[],taskOptions:[],UserOptions:[],tasksname:"",task:"",specVisiable:!1,editVisiable:!1,list:{id:"",userId:"",logsDate:"",logsContent:"",durTime:"",extTime:"",startDate:"",endDate:"",username:"",logsDetails:[]},deleteId:[],Options:[{value:"项目任务",label:"项目任务"},{value:"日常工作",label:"日常工作"},{value:"其他",label:"其他"}],value1:"",status:"unchanged",logsDetails:{id:"",projectTaskId:"",logsId:"",dContent:"",dPlanPrecent:"",dActPrecent:"",dTaskType:"",memo:"",durtime:"",taskname:""},userTask:[]}},created:function(){var t=this;this.getTasks(),Object(o.e)().then(function(e){t.loading=!1,t.UserOptions=e.data}).catch(function(){t.UserOptions=[]}),this.getlogs(),this.getlogsdetailTask()},mounted:function(){},methods:{getlogsdetailTask:function(){var t=this,e=Object(r.d)().name;e=n()(e),Object(o.g)(e).then(function(e){t.userTask=e.data;for(var l=0;l<t.userTask.length;l++)t.handleSpecificationShow(),t.logsDetails.dPlanPrecent=t.userTask[l].planPercent,t.logsDetails.taskname=t.userTask[l].userTaskName,t.logsDetails.dActPrecent=t.userTask[l].userTaskActPercent,t.handleSpecificationAdd();t.automatic()}).catch(function(){t.$message.error({title:"失败",message:"自动获取任务失败"})})},getlogs:function(){this.list.logsDate=new Date,this.list.durTime="8",this.list.username=Object(r.d)().name},getTasks:function(){var t=this;Object(o.d)().then(function(e){t.taskOptions=e.data})},remoteMethodUser:function(t){var e=this;this.loading=!0,null==t||""==t?Object(o.e)().then(function(t){e.loading=!1,e.UserOptions=t.data}).catch(function(){e.UserOptions=[]}):(this.loading=!0,Object(o.f)(n()(t)).then(function(t){e.loading=!1,e.UserOptions=t.data}).catch(function(){e.list=[]}))},autoPlan:function(t){var e=this;""==t||null==t||void 0==t?this.logsDetails.dPlanPrecent="":Object(o.h)(n()(t)).then(function(t){e.logsDetails.dPlanPrecent=t.data,console.log(t.data)}).catch(function(){e.$message.error({title:"失败",message:"自动获取失败"})})},handleCancel:function(){var t=this;this.$store.state.tagsView.visitedViews.splice(this.$store.state.tagsView.visitedViews.findIndex(function(e){return e.path===t.$route.path}),1),this.$router.push({path:"/logManagement/logManagement"})},handleSpecificationDelete:function(t){var e=this.list.logsDetails.indexOf(t);this.list.logsDetails.splice(e,1),this.deleteId.push(t.id)},handleSpecificationShow:function(){this.value1="",this.logsDetails={id:"",projectTaskId:"",logsId:"",dContent:"",dPlanPrecent:"",dActPrecent:"",dTaskType:"",memo:"",taskname:""},this.specVisiable=!0},automatic:function(){for(var t=this,e=this.list.logsDetails.length,l="",s="",a=0;a<e;a++)l="任务名: "+this.list.logsDetails[a].taskname+"   计划完成: "+this.list.logsDetails[a].dPlanPrecent+"%   实际完成: "+this.list.logsDetails[a].dActPrecent+"%   花费时长: "+this.list.logsDetails[a].durtime+"\r\n",s+=l;""!=this.list.logsContent?this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$message({type:"success",message:"日志重置成功!"}),t.list.logsContent=s}).catch(function(){t.$message({type:"info",message:"已取消日志重置"})}):this.list.logsContent=s},handleSpecificationAdd:function(){var t=this.list.logsDetails.length;""==this.logsDetails.taskname||null==this.logsDetails.taskname||void 0==this.logsDetails.taskname?this.$message({message:"任务不能为空",type:"warning"}):(this.status="insert",console.log(this.logsDetails),this.$set(this.logsDetails,"status",this.status),this.logsDetails.dTaskType=this.value1,this.list.logsDetails.splice(t,0,this.logsDetails),this.specVisiable=!1,this.logsDetails.taskname,console.log(this.list.logsDetails))},handleUpdate:function(t){this.editVisiable=!0,this.logsDetails=t,console.log(t),this.logsDetails.taskname=t.taskname,this.value1=t.dTaskType;for(var e=0;e<this.list.logsDetails.length;e++)t.taskname==this.list.logsDetails[e].taskname&&"insert"!==t.status&&(this.status="update",this.$set(this.list.logsDetails[e],"status",this.status));this.rowId=t.id},handleEdit:function(){var t=this;this.$set(this.list,"deleteId",this.deleteId);var e=n()(this.list);console.log(this.list),console.log(void 0===e?"undefined":a()(e)),Object(o.i)(e).then(function(e){t.$message.success({title:"成功",message:"保存成功"})}).catch(function(e){t.$message.error({title:"失败",message:"保存失败"})})},updateComplete:function(){this.logsDetails.dTaskType=this.value1;for(var t=0,e=0;e<this.list.logsDetails.length;e++)""!=this.list.logsDetails[e].taskname&&null!=this.list.logsDetails[e].taskname||(this.$message.error({title:"失败",message:"任务不能为空"}),t++);if(0==t){for(var l=0;l<this.list.logsDetails.length;l++)this.rowId===this.list.logsDetails[l].id&&(this.list.logsDetails[l].taskname=this.logsDetails.taskname);this.editVisiable=!1}}},filters:{}},u=(l("QPME"),l("KHd+")),d=Object(u.a)(c,function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("div",{staticClass:"page-content"},[l("el-card",{staticClass:"box-card"},[l("el-form",{ref:"list",attrs:{inline:!0,model:t.list,"label-width":"100px"}},[l("el-form-item",{attrs:{label:"用户姓名",prop:"username"}},[l("el-select",{staticStyle:{width:"185px"},attrs:{filterable:"",remote:"",clearable:"","remote-method":t.remoteMethodUser,loading:t.loading,placeholder:"请输入关键词"},model:{value:t.list.username,callback:function(e){t.$set(t.list,"username",e)},expression:"list.username"}},t._l(t.UserOptions,function(t){return l("el-option",{attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),l("el-form-item",{attrs:{label:"填写时间",prop:"logsDate"}},[l("el-date-picker",{staticStyle:{width:"185px"},attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:t.list.logsDate,callback:function(e){t.$set(t.list,"logsDate",e)},expression:"list.logsDate"}})],1),t._v(" "),l("el-form-item",{attrs:{label:"工作时长",prop:"durTime"}},[l("el-input",{attrs:{oninput:"value=value.replace(/[^\\d]/g,'')",maxLength:"2",placeholder:"请输入整数"},model:{value:t.list.durTime,callback:function(e){t.$set(t.list,"durTime",e)},expression:"list.durTime"}})],1),t._v(" "),l("el-form-item",{attrs:{label:"加班时长",prop:"extTime"}},[l("el-input",{attrs:{oninput:"value=value.replace(/[^\\d]/g,'')",maxLength:"2",placeholder:"请输入整数"},model:{value:t.list.extTime,callback:function(e){t.$set(t.list,"extTime",e)},expression:"list.extTime"}})],1)],1),t._v(" "),l("el-form",{ref:"list",attrs:{model:t.list,"label-width":"100px"}},[l("el-form-item",{attrs:{label:"日志",prop:"logsContent"}},[l("el-input",{attrs:{type:"textarea",rows:3,maxlength:"300","show-word-limit":"",placeholder:"请输入日志内容"},model:{value:t.list.logsContent,callback:function(e){t.$set(t.list,"logsContent",e)},expression:"list.logsContent"}})],1)],1),t._v(" "),l("el-button",{attrs:{plain:!0,type:"primary",icon:"el-icon-s-promotion"},on:{click:t.automatic}},[t._v("生成日志")])],1),t._v(" "),l("el-card",{staticClass:"box-card"},[l("h3",[t._v("日志明细")]),t._v(" "),l("el-button",{attrs:{plain:!0,type:"primary"},on:{click:t.handleSpecificationShow}},[t._v("添加")]),t._v(" "),l("el-table",{staticStyle:{"margin-top":"10px"},attrs:{data:t.list.logsDetails,border:"",fit:"","highlight-current-row":""}},[l("el-table-column",{attrs:{align:"center",label:"任务",prop:"taskname"}}),t._v(" "),l("el-table-column",{attrs:{align:"center",label:"计划完成%",prop:"dPlanPrecent"}}),t._v(" "),l("el-table-column",{attrs:{align:"center",label:"实际完成%",prop:"dActPrecent"}}),t._v(" "),l("el-table-column",{attrs:{align:"center",label:"任务类型",prop:"dTaskType"}}),t._v(" "),l("el-table-column",{attrs:{align:"center",label:"备注",prop:"memo"}}),t._v(" "),l("el-table-column",{attrs:{align:"center",label:"花费时长",prop:"durtime"}}),t._v(" "),l("el-table-column",{attrs:{align:"center",label:"操作",fixed:"right",width:"200","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){return[l("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(l){return t.handleUpdate(e.row)}}},[t._v("编辑")]),t._v(" "),l("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(l){return t.handleSpecificationDelete(e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),l("el-dialog",{attrs:{visible:t.editVisiable,title:"编辑日志明细"},on:{"update:visible":function(e){t.editVisiable=e}}},[l("el-form",{ref:"attributeForm",staticStyle:{width:"400px","margin-left":"50px"},attrs:{model:t.logsDetails,"status-icon":"","label-position":"left","label-width":"100px"}},[l("el-form-item",{attrs:{label:"任务"}},[l("el-select",{staticStyle:{width:"300px"},attrs:{clearable:"",loading:t.loading,placeholder:"请选择"},on:{change:function(e){return t.autoPlan(e)}},model:{value:t.logsDetails.taskname,callback:function(e){t.$set(t.logsDetails,"taskname",e)},expression:"logsDetails.taskname"}},t._l(t.taskOptions,function(e){return l("el-option-group",{key:e.name,attrs:{label:e.name}},t._l(e.projectTasks,function(t){return l("el-option",{key:t.id,attrs:{label:t.tTask,value:t.tTask}})}),1)}),1)],1),t._v(" "),l("el-form-item",{attrs:{label:"计划完成%"}},[l("el-input",{model:{value:t.logsDetails.dPlanPrecent,callback:function(e){t.$set(t.logsDetails,"dPlanPrecent",e)},expression:"logsDetails.dPlanPrecent"}})],1),t._v(" "),l("el-form-item",{attrs:{label:"实际完成%"}},[l("el-input",{attrs:{oninput:"value=value.replace(/[^\\d]/g,'')",maxLength:"3",clearable:"",placeholder:"请输入整数"},model:{value:t.logsDetails.dActPrecent,callback:function(e){t.$set(t.logsDetails,"dActPrecent",e)},expression:"logsDetails.dActPrecent"}})],1),t._v(" "),l("el-form-item",{attrs:{label:"任务类型"}},[l("el-select",{staticStyle:{width:"300px"},attrs:{placeholder:"请选择"},model:{value:t.value1,callback:function(e){t.value1=e},expression:"value1"}},t._l(t.Options,function(t){return l("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),l("el-form-item",{attrs:{label:"备注"}},[l("el-input",{attrs:{type:"textarea",rows:3,maxlength:"50","show-word-limit":"",placeholder:"请输入备注内容"},model:{value:t.logsDetails.memo,callback:function(e){t.$set(t.logsDetails,"memo",e)},expression:"logsDetails.memo"}})],1),t._v(" "),l("el-form-item",{attrs:{label:"花费时长"}},[l("el-input",{attrs:{oninput:"value=value.replace(/[^\\d]/g,'')",maxLength:"2",clearable:"",placeholder:"请输入整数"},model:{value:t.logsDetails.durtime,callback:function(e){t.$set(t.logsDetails,"durtime",e)},expression:"logsDetails.durtime"}})],1)],1),t._v(" "),l("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(e){t.editVisiable=!1}}},[t._v("取消")]),t._v(" "),l("el-button",{attrs:{type:"primary"},on:{click:t.updateComplete}},[t._v("确定")])],1)],1),t._v(" "),l("el-dialog",{attrs:{visible:t.specVisiable,title:"添加日志明细"},on:{"update:visible":function(e){t.specVisiable=e}}},[l("el-form",{ref:"attributeForm",staticStyle:{width:"400px","margin-left":"50px"},attrs:{model:t.logsDetails,"status-icon":"","label-position":"left","label-width":"100px"}},[l("el-form-item",{attrs:{label:"任务"}},[l("el-select",{staticStyle:{width:"300px"},attrs:{clearable:"",loading:t.loading,placeholder:"请选择"},on:{change:function(e){return t.autoPlan(e)}},model:{value:t.logsDetails.taskname,callback:function(e){t.$set(t.logsDetails,"taskname",e)},expression:"logsDetails.taskname"}},t._l(t.taskOptions,function(e){return l("el-option-group",{key:e.name,attrs:{label:e.name}},t._l(e.projectTasks,function(t){return l("el-option",{key:t.id,attrs:{label:t.tTask,value:t.tTask}})}),1)}),1)],1),t._v(" "),l("el-form-item",{attrs:{label:"计划完成%"}},[l("el-input",{model:{value:t.logsDetails.dPlanPrecent,callback:function(e){t.$set(t.logsDetails,"dPlanPrecent",e)},expression:"logsDetails.dPlanPrecent"}})],1),t._v(" "),l("el-form-item",{attrs:{label:"实际完成%"}},[l("el-input",{attrs:{oninput:"value=value.replace(/[^\\d]/g,'')",maxLength:"3",placeholder:"请输入整数"},model:{value:t.logsDetails.dActPrecent,callback:function(e){t.$set(t.logsDetails,"dActPrecent",e)},expression:"logsDetails.dActPrecent"}})],1),t._v(" "),l("el-form-item",{attrs:{label:"任务类型"}},[l("el-select",{staticStyle:{width:"300px"},attrs:{placeholder:"请选择"},model:{value:t.value1,callback:function(e){t.value1=e},expression:"value1"}},t._l(t.Options,function(t){return l("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),l("el-form-item",{attrs:{label:"备注"}},[l("el-input",{attrs:{type:"textarea",rows:3,maxlength:"50","show-word-limit":"",placeholder:"请输入备注内容"},model:{value:t.logsDetails.memo,callback:function(e){t.$set(t.logsDetails,"memo",e)},expression:"logsDetails.memo"}})],1),t._v(" "),l("el-form-item",{attrs:{label:"花费时长"}},[l("el-input",{attrs:{oninput:"value=value.replace(/[^\\d]/g,'')",maxLength:"3",placeholder:"请输入整数"},model:{value:t.logsDetails.durtime,callback:function(e){t.$set(t.logsDetails,"durtime",e)},expression:"logsDetails.durtime"}})],1)],1),t._v(" "),l("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(e){t.specVisiable=!1}}},[t._v("取消")]),t._v(" "),l("el-button",{attrs:{type:"primary"},on:{click:t.handleSpecificationAdd}},[t._v("确定")])],1)],1)],1),t._v(" "),l("div",{staticClass:"op-container"},[l("el-button",{on:{click:t.handleCancel}},[t._v("取消")]),t._v(" "),l("el-button",{attrs:{type:"primary"},on:{click:t.handleEdit}},[t._v("保存")])],1)],1)},[],!1,null,"5b958300",null);d.options.__file="create.vue";e.default=d.exports},QPME:function(t,e,l){"use strict";var s=l("VSu2");l.n(s).a},VSu2:function(t,e,l){}}]);