(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-0c1b"],{Bvle:function(e,t,s){},WnmT:function(e,t,s){"use strict";s.d(t,"e",function(){return r}),s.d(t,"d",function(){return a}),s.d(t,"a",function(){return o}),s.d(t,"j",function(){return l}),s.d(t,"g",function(){return n}),s.d(t,"i",function(){return c}),s.d(t,"h",function(){return u}),s.d(t,"b",function(){return p}),s.d(t,"c",function(){return d}),s.d(t,"f",function(){return h});var i=s("t3Un");function r(e,t){return Object(i.a)({url:"/task/selectTaskWithProject/?pageSize="+e+"&pageNum="+t,method:"get"})}function a(e,t,s){return Object(i.a)({url:"/task/selectTaskWithProjectByName/?pageSize="+e+"&pageNum="+t+"&name="+s})}function o(e){return Object(i.a)({url:"/task/delete/?id="+e.id,method:"get"})}function l(e){return Object(i.a)({url:"/task/getTaskDetailById/?id="+e,method:"get"})}function n(e){return Object(i.a)({url:"/users/getUserByExample",method:"post",data:e})}function c(e){return Object(i.a)({url:"/task/taskGetDetailUpdate",method:"post",data:e})}function u(e){return Object(i.a)({url:"/task/taskGetDetailInsert",method:"post",data:e})}function p(){return Object(i.a)({url:"/project/getAllProject",method:"get"})}function d(){return Object(i.a)({url:"/task/selectAlltask",method:"get"})}function h(){return Object(i.a)({url:"/users/getAllUser",method:"get"})}},n9gU:function(e,t,s){"use strict";var i=s("Bvle");s.n(i).a},uLhs:function(e,t,s){"use strict";s.r(t);var i=s("EJiy"),r=s.n(i),a=s("gDS+"),o=s.n(a),l=s("WnmT"),n={name:"Edit",data:function(){return{rowId:"",loading:!1,value:[],taskOptions:[],ProjectOptions:[],UserOptions:[],AssigorUserOptions:[],ReceiveUserOptions:[],tasksname:"",task:"",specVisiable:!1,editVisiable:!1,list:null,deleteId:[],status:"unchanged",projectTaskResources:{id:"",projectTaskId:"",userId:"",receiveUser:"",memo:"",time:"",endtime:""}}},created:function(){var e=this;this.getList(),this.getProject(),Object(l.f)().then(function(t){e.ReceiveUserOptions=t.data,e.AssigorUserOptions=t.data}).catch(function(){e.ReceiveUserOptions=[]})},mounted:function(){},methods:{init:function(){if(null==this.$route.query.id)return!1},getList:function(){var e=this;Object(l.j)(this.$route.query.id).then(function(t){e.list=t.data;for(var s=0;s<e.list.projectTaskResources.length;s++)e.$set(e.list.projectTaskResources[s],"status",e.status);console.log(e.list)}).catch(function(){e.list=[]})},getProject:function(){var e=this;Object(l.b)().then(function(t){e.ProjectOptions=t.data,console.log(e.ProjectOptions)})},getTasks:function(){var e=this;getTasksList().then(function(t){e.taskOptions=t.data})},remoteMethodAssigorUser:function(e){var t=this;null==e||""==e?Object(l.f)().then(function(e){t.AssigorUserOptions=e.data}).catch(function(){t.ReceiveUserOptions=[]}):(this.loading=!0,Object(l.g)(o()(e)).then(function(e){t.loading=!1,t.AssigorUserOptions=e.data}).catch(function(){t.list=[]}))},remoteMethodReceiveUser:function(e){var t=this;null==e||""==e?Object(l.f)().then(function(e){t.ReceiveUserOptions=e.data}).catch(function(){t.ReceiveUserOptions=[]}):(this.loading=!0,Object(l.g)(o()(e)).then(function(e){t.loading=!1,t.ReceiveUserOptions=e.data}).catch(function(){t.list=[]}))},handleCancel:function(){var e=this;this.$store.state.tagsView.visitedViews.splice(this.$store.state.tagsView.visitedViews.findIndex(function(t){return t.path===e.$route.path}),1),this.$router.push({path:"/taskSheet/taskSheet"})},handleSpecificationDelete:function(e){var t=this.list.projectTaskResources.indexOf(e);this.list.projectTaskResources.splice(t,1),this.deleteId.push(e.id)},handleSpecificationShow:function(){this.projectTaskResources={id:"",projectTaskId:"",userId:"",receiveUser:"",memo:"",time:"",endtime:""},this.specVisiable=!0},handleSpecificationAdd:function(){var e=this.list.projectTaskResources.length;if(""===this.projectTaskResources.receiveUser||null==this.projectTaskResources.receiveUser||void 0==this.projectTaskResources.receiveUser)this.$message({message:"接收人不能为空",type:"warning"});else{for(var t=0,s=0;s<e;s++)this.projectTaskResources.receiveUser===this.list.projectTaskResources[s].receiveUser&&t++;0!=t?this.$message({message:"接收人不能为重复",type:"warning"}):(this.status="insert",this.$set(this.projectTaskResources,"status",this.status),this.list.projectTaskResources.splice(e,0,this.projectTaskResources),this.specVisiable=!1,console.log(this.list.logsDetails))}},handleUpdate:function(e){this.editVisiable=!0,this.projectTaskResources=e,console.log(e);for(var t=0;t<this.list.projectTaskResources.length;t++)e.receiveUser==this.list.projectTaskResources[t].receiveUser&&"insert"!==e.status&&(this.status="update",this.$set(this.list.projectTaskResources[t],"status",this.status));this.rowId=e.id,console.log(this.projectTaskResources)},handleEdit:function(){var e=this;this.$set(this.list,"deleteId",this.deleteId);var t=o()(this.list);console.log(this.list),console.log(void 0===t?"undefined":r()(t)),Object(l.i)(t).then(function(t){e.$message.success({title:"成功",message:"更新成功"})}).catch(function(t){e.$message.error({title:"失败",message:"更新失败"})})},updateComplete:function(){for(var e=0,t=0;t<this.list.projectTaskResources.length;t++)""!=this.list.projectTaskResources[t].receiveUser&&null!=this.list.projectTaskResources[t].receiveUser||(this.$message.error({title:"失败",message:"接收人不能为空"}),e++);if(0==e){for(var s=this.list.projectTaskResources.length,i=0,r=0;r<s;r++)for(var a=r+1;a<s;a++)this.list.projectTaskResources[r].receiveUser==this.list.projectTaskResources[a].receiveUser&&i++;console.log(i),0!=i?this.$message({message:"接收人不能重复",type:"warning"}):this.editVisiable=!1}}},filters:{}},c=(s("n9gU"),s("KHd+")),u=Object(c.a)(n,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page-content"},[s("el-card",{staticClass:"box-card"},[s("el-form",{ref:"list",attrs:{inline:!0,model:e.list,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"所属项目",prop:"pName"}},[s("el-select",{staticStyle:{width:"185px"},attrs:{clearable:"",placeholder:"请选择"},model:{value:e.list.pName,callback:function(t){e.$set(e.list,"pName",t)},expression:"list.pName"}},e._l(e.ProjectOptions,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),s("el-form-item",{attrs:{label:"人天",prop:"tPersonday"}},[s("el-input",{staticStyle:{width:"185px"},attrs:{oninput:"value=value.replace(/[^\\d]/g,'')",maxLength:"3",clearable:"",placeholder:"请输入整数"},model:{value:e.list.tPersonday,callback:function(t){e.$set(e.list,"tPersonday",t)},expression:"list.tPersonday"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"进度",prop:"tActPercent"}},[s("el-input",{staticStyle:{width:"185px"},attrs:{oninput:"value=value.replace(/[^\\d]/g,'')",maxLength:"3",clearable:"",placeholder:"请输入整数"},model:{value:e.list.tActPercent,callback:function(t){e.$set(e.list,"tActPercent",t)},expression:"list.tActPercent"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"指派人",prop:"username"}},[s("el-select",{staticStyle:{width:"185px"},attrs:{filterable:"",remote:"",clearable:"","remote-method":e.remoteMethodAssigorUser,loading:e.loading,placeholder:"请输入指派人姓名"},model:{value:e.list.assigonrUser,callback:function(t){e.$set(e.list,"assigonrUser",t)},expression:"list.assigonrUser"}},e._l(e.AssigorUserOptions,function(e){return s("el-option",{attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),s("el-form-item",{attrs:{label:"开始时间",prop:"tStartDate"}},[s("el-date-picker",{staticStyle:{width:"185px"},attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.list.tStartDate,callback:function(t){e.$set(e.list,"tStartDate",t)},expression:"list.tStartDate"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"结束时间",prop:"tEndDate"}},[s("el-date-picker",{staticStyle:{width:"185px"},attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.list.tEndDate,callback:function(t){e.$set(e.list,"tEndDate",t)},expression:"list.tEndDate"}})],1)],1),e._v(" "),s("el-form",{ref:"list",attrs:{model:e.list,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"任务",prop:"tTask"}},[s("el-input",{attrs:{type:"textarea",rows:3,maxlength:"150","show-word-limit":"",placeholder:"请输入任务具体内容"},model:{value:e.list.tTask,callback:function(t){e.$set(e.list,"tTask",t)},expression:"list.tTask"}})],1)],1)],1),e._v(" "),s("el-card",{staticClass:"box-card"},[s("h3",[e._v("任务人员安排")]),e._v(" "),s("el-button",{attrs:{plain:!0,type:"primary"},on:{click:e.handleSpecificationShow}},[e._v("添加")]),e._v(" "),s("el-table",{staticStyle:{"margin-top":"10px"},attrs:{data:e.list.projectTaskResources,border:"",fit:"","highlight-current-row":""}},[s("el-table-column",{attrs:{align:"center",label:"接收人",prop:"receiveUser"}}),e._v(" "),s("el-table-column",{attrs:{align:"center",label:"备注",prop:"memo"}}),e._v(" "),s("el-table-column",{attrs:{align:"center",label:"操作",fixed:"right",width:"200","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(s){return e.handleUpdate(t.row)}}},[e._v("编辑")]),e._v(" "),s("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(s){return e.handleSpecificationDelete(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),s("el-dialog",{attrs:{visible:e.editVisiable,title:"编辑任务成员"},on:{"update:visible":function(t){e.editVisiable=t}}},[s("el-form",{ref:"attributeForm",staticStyle:{width:"400px","margin-left":"50px"},attrs:{model:e.projectTaskResources,"status-icon":"","label-position":"left","label-width":"100px"}},[s("el-form-item",{attrs:{label:"接收人",prop:"receiveUser"}},[s("el-select",{staticStyle:{width:"300px"},attrs:{filterable:"",remote:"",clearable:"","remote-method":e.remoteMethodReceiveUser,loading:e.loading,placeholder:"请输入接收人姓名"},model:{value:e.projectTaskResources.receiveUser,callback:function(t){e.$set(e.projectTaskResources,"receiveUser",t)},expression:"projectTaskResources.receiveUser"}},e._l(e.ReceiveUserOptions,function(e){return s("el-option",{attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),s("el-form-item",{attrs:{label:"备注",prop:"memo"}},[s("el-input",{attrs:{type:"textarea",rows:3,maxlength:"50","show-word-limit":"",placeholder:"请输入备注内容"},model:{value:e.projectTaskResources.memo,callback:function(t){e.$set(e.projectTaskResources,"memo",t)},expression:"projectTaskResources.memo"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.editVisiable=!1}}},[e._v("取消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.updateComplete}},[e._v("确定")])],1)],1),e._v(" "),s("el-dialog",{attrs:{visible:e.specVisiable,title:"添加任务成员"},on:{"update:visible":function(t){e.specVisiable=t}}},[s("el-form",{ref:"attributeForm",staticStyle:{width:"400px","margin-left":"50px"},attrs:{model:e.projectTaskResources,"status-icon":"","label-position":"left","label-width":"100px"}},[s("el-form-item",{attrs:{label:"接收人",prop:"receiveUser"}},[s("el-select",{staticStyle:{width:"300px"},attrs:{filterable:"",remote:"",clearable:"","remote-method":e.remoteMethodReceiveUser,loading:e.loading,placeholder:"请输入接收人姓名"},model:{value:e.projectTaskResources.receiveUser,callback:function(t){e.$set(e.projectTaskResources,"receiveUser",t)},expression:"projectTaskResources.receiveUser"}},e._l(e.ReceiveUserOptions,function(e){return s("el-option",{attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),s("el-form-item",{attrs:{label:"备注",prop:"memo"}},[s("el-input",{attrs:{type:"textarea",rows:3,maxlength:"50","show-word-limit":"",placeholder:"请输入备注内容"},model:{value:e.projectTaskResources.memo,callback:function(t){e.$set(e.projectTaskResources,"memo",t)},expression:"projectTaskResources.memo"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.specVisiable=!1}}},[e._v("取消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.handleSpecificationAdd}},[e._v("确定")])],1)],1)],1),e._v(" "),s("div",{staticClass:"op-container"},[s("el-button",{on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.handleEdit}},[e._v("保存")])],1)],1)},[],!1,null,"178ae959",null);u.options.__file="edit.vue";t.default=u.exports}}]);